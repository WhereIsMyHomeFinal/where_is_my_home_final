<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.homeapp.model.dao.InterestingDAO">

	<select id="getPlaces" parameterType="string" resultMap="com.ssafy.resultmaps.IPResultMap">
		select i.userid, i.dongName, s.sidoName, g.gugunName, i.lat, i.lng
		from interestingplaces i, guguncode g, sidocode s 
		where userid = #{userid} and i.gugunName = g.gugunName and i.sidoName = s.sidoName 
	</select>

	<select id="getPlace" parameterType="map" resultType="InterestingPlace">
		select userid, dongName, sidoName, gugunName, lat, lng
		from interestingplaces
		where dongName = #{dongName} and userid = #{userid} 
	</select>
	
	<insert id="registerPlace" parameterType="InterestingPlace">
		insert into interestingplaces
		values (#{userid}, #{dongName}, #{sidoName}, #{gugunName},
		(select lat from baseaddress where dongName = #{dongName}),
		(select lng from baseaddress where dongName = #{dongName}))
	</insert>
	
	<delete id="deletePlace" parameterType="map">
		delete from interestingplaces
		where userid = #{userid} and dongName = #{dongName}
	</delete>
	
	<select id="getCommercialArea" parameterType="string" resultMap="com.ssafy.resultmaps.CAResultMap">
		select name, lat, lng 
		from commercialareainfo 
		where dongName = #{dongName} limit 20
	</select>
	
</mapper>